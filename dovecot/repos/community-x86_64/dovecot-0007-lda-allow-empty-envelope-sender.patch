From 6553f20bb31b5f0eebb73a0db526f00816b47d71 Mon Sep 17 00:00:00 2001
From: Stephan Bosch <stephan.bosch@dovecot.fi>
Date: Sun, 8 Apr 2018 11:28:19 +0200
Subject: [PATCH] lda: Allow empty envelope sender.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Fix by Martin Waschb√ºsch.
---
 src/lda/main.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/lda/main.c b/src/lda/main.c
index bab20e88ad..1d7c8473d2 100644
--- a/src/lda/main.c
+++ b/src/lda/main.c
@@ -332,7 +332,8 @@ int main(int argc, char *argv[])
 		case 'f':
 			/* envelope sender address */
 			if (smtp_address_parse_path(ctx.pool, optarg,
-			    SMTP_ADDRESS_PARSE_FLAG_BRACKETS_OPTIONAL,
+			    SMTP_ADDRESS_PARSE_FLAG_BRACKETS_OPTIONAL |
+				SMTP_ADDRESS_PARSE_FLAG_ALLOW_EMPTY,
 			    &mail_from, &errstr) < 0) {
 				i_fatal_status(EX_USAGE,
 					"Invalid -f parameter: %s", errstr);
